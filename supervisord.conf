[supervisord]
nodaemon=true    ; Keeps supervisord in the foreground (required for Docker)
user=appuser     ; Run as non-root user

[program:telethon_listener]
command=/bin/bash -c "python -u /app/src/listener-db.py 2>&1 | tee /tmp/telethon_listener.out.log"
directory=/app
autostart=true
autorestart=true
startretries=3
; Use tee to write to both file and stdout
; File is for Flask, stdout goes to docker logs
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:flask_app]
command=python /app/app.py
directory=/app
autostart=true
autorestart=true
startretries=3
redirect_stderr=true
; Write output logs to /tmp/flask_app.log
stdout_logfile=/tmp/flask_app.log
stdout_logfile_maxbytes=50MB
